# RSA Internal Attacker

```py
def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, y, x = egcd(b % a, a)
        return (g, x - (b // a) * y, y)

def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('modular inverse does not exist')
    else:
        return x % m

n = 17871804833534052595464329898530095180096953557733851645461301860404269891595028790940386395025766448581132736938564627557155990574456324251636951365886311489964622824516845700040737763552652245709633360148079804040400869014337108478315951891327941365611819654870648679859169516191143374766339747653796267056907388109016190484622123367610524891960431173910773704251376394291815662115937191088021832142842670862569574617398297714503782266351320455110662814194656382759590587977373014999633883665205702176199561880672264926452907882883281245595626761503332420192857837803393484977026020329907891159389480219952210020591
e = 32917
d = 4246297827963357090534572535054952589954682193852308950364639604162645284265416659292911322280174967170551360561306132154343257352821426982168867048412578368715658022011308752924586385416207224646688413577122220961812291416627594416529728096183608148386853040093062652282363665769387621412873079758190011381656325862514638373649427145066863050181672817011696047038504962667048754166228256857597186832134826613639195836202429905488915365759478874385957444894769446500679176558381513304606555860954789761775749920224429604385686905938218735069232043102720263722007656272148948217059212199893455527634667077529188262653

e_boss = 8891

k = int(((e*d)-1)/n)
#print(k)
while True:
    try :
        phi = ((e*d)-1)//k
        if(phi*k == ((e*d)-1)):
            #print(phi)
            break
        k = k+1
        print('[*]')
    except:
        continue
m = 4178158038163959503406890044813417931203801416606959386054118132462412954926124841606241909514420414469749337367158619439925570687104062821265716968595904421189936944134174970215208122698290881744526322997189177479216860927647742591656531958662912969538508985385690880493076286388749431237806720718877311272759442132373753803394293388771739758237343424262520074160121279782838752049563731846995785706984816610117242109713371287606018288881455837564261607861286525018353063197118178821339424116924801123342205917274993405064141855225470458185185022945425959685469196856432330284814132041742252337800397111992666272629


print(modinv(e,phi)==d)
d_boss = modinv(e_boss,phi)
res = pow(m,d_boss,n)
print(res)
res = 50672773416769664601301631322307323851268557540707476013905838184235814981379340846999735819020848998679569461885
'''
from Crypto.Util.number import long_to_bytes
print(long_to_bytes(50672773416769664601301631322307323851268557540707476013905838184235814981379340846999735819020848998679569461885))

THCon21{coMm0n_m0duLus_wh1th_int3rn4l_aTt4ck3r}
```
